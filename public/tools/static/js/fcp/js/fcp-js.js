baidu.namespace.register("baidu.js");baidu.js=(function(){var y=null;var d=0;var B=0;var s=[];_cookies=[];var m=null;var g=function(D){y={curIndex:0,queen:[],callback:new Function(),finished:D}};var A=function(D){y.queen.push(D)};var i=function(){return y.queen[y.curIndex]};var o=function(){return(y.curIndex==y.queen.length)};var n=function(){y.curIndex+=1};var l=function(){return y.finished};var w=function(F){var D=/(.*\/)([^\/]+\.js)/;var E=D.exec((F||"").replace(/\?.*/,""));return E?E[2]:F?("异步接口"+ ++d):("script块"+ ++B)};var b=function(){m={cookies:[],scriptTag:{scriptBlock:0,scriptSrc:0},domain:false,jsMinified:{files:[],count:0},tangram:[],duplicatedFiles:[]}};var x=function(F,E){E=E.replace(/\/\*[\S\s]*?\*\//g,"");var D=w(F);s.push({href:F?F:"#",fileName:D,fileContent:E})};var k=function(D){var E=(function(){var F={src:[],block:[]};jQuery.each(D,function(H,G){if(!!G.src){F.src.push(G)}else{if(!!G.innerHTML){F.block.push(G)}}});return F})();return E};var C=function(D){chrome.extension.sendMessage({type:MSG_TYPE.GET_JS,link:D.src},function(E){x(E.path,E.content);r()})};var e=function(D){x("",D.innerHTML);r()};var r=function(){var D=i();if(l()||!D){chrome.extension.sendMessage({type:MSG_TYPE.JS_READY});return}n();if(o()){g(true)}if(!!D.block){e(D.block)}else{if(!!D.src){C(D.src)}}};var v=function(){scripts=k(document.scripts);if(scripts.block&&scripts.block.length>0){jQuery.each(scripts.block,function(E,D){A({src:null,block:D})})}if(scripts.src&&scripts.src.length>0){jQuery.each(scripts.src,function(D,E){A({src:E,block:null})})}r()};var h=function(){var D=false;jQuery.each(s,function(E,F){z(F)});m.scriptTag={scriptSrc:jQuery("script[src]").length,scriptBlock:jQuery("script:not(script[src])").length}};var z=function(D){var F=D.fileName;var E=D.fileContent;c(D)};var t=function(){chrome.extension.sendMessage({type:MSG_TYPE.GET_COOKIE,url:location.href},function(D){_cookies=D.cookie})};var p=function(){m.cookies=_cookies};var c=function(F){var D=F.fileContent.split(/\n/);var E=F.fileContent.length/D.length;if(E<150&&D.length>1){m.jsMinified.count++;m.jsMinified.files.push({href:F.href,fileName:F.fileName})}};var u=function(){var E=document.querySelectorAll("script[src]");var D=[];jQuery.each(E,function(G,H){if(!H.src){return true}var F=w(H.src);if(F.indexOf("tangram")>-1){D.push(F)}});m.tangram=D};var q=function(){scripts=k(document.scripts);var F={};var E=[];var D={};if(scripts.src&&scripts.src.length>0){jQuery.each(scripts.src,function(G,H){F[H.src]=parseInt(F[H.src]||0,10)+1});jQuery.each(F,function(G,I){if(I>1){E.push({href:G,count:I})}else{var H="";var J=[];jQuery.each(s,function(L,K){if(K.href==G){H=K.fileContent.replace(/\s+/g,"");return false}});jQuery.each(s,function(L,K){if(H==K.fileContent.replace(/\s+/g,"")&&!D[K.href]&&J.join(",").indexOf(K.href)==-1){J.push(K.href)}});if(J.length>1){E.push({href:G,dupFiles:J});D[G]=true}}})}m.duplicatedFiles=E};var a=function(){h()};var j=function(){g(false);v();t()};var f=function(D){b();p();a();u();q();D.call(null,m)};return{init:j,detect:f,getCookies:t}})();