baidu.namespace.register("baidu.html");baidu.html=(function(){var s="";var p=null;var a=function(){p={HTMLBase:{HTMLDeprecatedAttribute:{},HTMLDeprecatedTag:{}},documentMode:{hasDocType:false,compatMode:{IE:"Q",WebKit:"Q"},publicId:"",hasComment:false,hasConditionalComment:false,isUnusualDocType:false},DOM:{IECondComm:[],FFNotSptComm:[],allComm:[],count:0,invalidInput:{count:0,input:[]},maxDepth:{xpath:"",depth:1}},title:[],LINK:{notInHead:[]},ID:{ids:{},count:0},tagInclude:[],unClosedTags:[],htmlMinified:true,imgTag:[]}};var u=function(x){return HTML_DEPRECATED_TAGS[x.toLowerCase()]};var t=function(y,x){y=y.toLowerCase();x=x.toLowerCase();return(HTML_DEPRECATED_ATTRIBUTES[x]&&HTML_DEPRECATED_ATTRIBUTES[x][y])};var e=function(z){var y=z.tagName.toLowerCase();if(u(y)){var x=p.HTMLBase.HTMLDeprecatedTag;if(!x[y]){x[y]=0}x[y]++}};var i=function(C){var B=C.tagName.toLowerCase();var x=C.attributes;var z=p.HTMLBase.HTMLDeprecatedAttribute;for(var y=0,D=x.length;y<D;++y){var A=x[y].name;if(t(B,A)){if(!z[A]){z[A]={}}if(!z[A][B]){z[A][B]=0}z[A][B]++}}};var g=function(z,x){var B=document.createNodeIterator(z,x,null,false);var y=[];var A=B.nextNode();while(A){y.push(A);A=B.nextNode()}return y};var o=function(){var x=g(document.documentElement,NodeFilter.SHOW_COMMENT);var C=/\[\s*if\s*[^\]][\s\w]*\]/i;var A=/--/g;for(var z=0,B=x.length;z<B;++z){var y=x[z];if(C.test(y.nodeValue)){p.DOM.IECondComm.push(y.nodeValue)}if(A.test(y.nodeValue)){p.DOM.FFNotSptComm.push(y.nodeValue)}p.DOM.allComm.push(y.nodeValue)}};var v=function(){p.documentMode=baidu.doctype.getDocMode()};var n=function(y){var x=p.ID;for(var z in y){if(y[z]>1){x.ids[z]=y[z];x.count++}}};var q=function(B){if(B.nodeType!==1||!B.tagName){return}if(B.id==="fe-helper-tab-box"||B.id==="fe-helper-pb-mask"){return}var C=p.DOM.maxDepth;var A=0;var y,x=[];do{if(B.id==="fe-helper-tab-box"||B.id==="fe-helper-pb-mask"){return}if(B.tagName.toLowerCase()=="svg"){continue}try{if(B.id){y=B.tagName.toLowerCase()+'<span style="color:red;">#'+B.id+"</span>"}else{if(B.className){y=B.tagName.toLowerCase()+'<span style="color:green;">.'+B.className.split(/\s+/).join(".")+"</span>"}else{y=B.tagName.toLowerCase()}}}catch(z){continue}A++;x.unshift(y)}while((B=B.parentNode)&&B.nodeType===1);if(A>C.depth){C.depth=A;C.xpath=x.join('<span style="color:gray;">&gt;</span>')}};var w=function(){var B=g(document.documentElement,NodeFilter.SHOW_ELEMENT);p.DOM.count=B.length;var y={};for(var A=0,x=B.length;A<x;++A){var z=B[A];e(z);i(z);q(z);if(!!z.id){if(!y[z.id]){y[z.id]=0}y[z.id]++}}n(y)};var m=function(){var y=document.querySelectorAll("link");var z=document.querySelectorAll("head link");var x=[];jQuery.each(y,function(B,C){var A=true;jQuery.each(z,function(E,D){if(C.href==D.href){A=false}});A?x.push(C):false});p.LINK.notInHead=x};var h=function(){var y=document.querySelectorAll("title");var z=document.querySelectorAll("head title");var x=false;var A=[];jQuery.each(y,function(C,B){x=false;jQuery.each(z,function(E,D){if(B==D){x=true;return false}});A.push({dom:B,isInHead:x})});p.title=A};var j=function(){var y=document.querySelectorAll("img[src]");var z=[];var A=/.*src=\"(.*)\".*/;var x=[];jQuery.each(y,function(C,B){x=A.exec(B.outerHTML);if(!x||x[1].trim()==""){z.push(B)}});p.imgTag=z};var r=function(){var x=document.querySelectorAll("input[type=text],input[type=password]");var y=p.DOM.invalidInput;jQuery.each(x,function(A,z){if(z.getAttribute("size")){y.count++;y.input.push(z)}})};var d=function(){var y=p.tagInclude;var z=null;var x=null;jQuery.each(INLINE_HTML_ELEMENT,function(B,A){jQuery.each(BLOCK_HTML_ELEMENT,function(C,D){z=document.querySelectorAll(A+">"+D);if(z.length>0){x=getOuterHtmlEllipsis(z[0].parentNode);jQuery.each(z,function(E,F){y.push({inline:x,block:getOuterHtmlEllipsis(F)})})}})})};var b=function(){var y=s;var z=new baidu.htmlAnalytic();var A=z.getUnclosedTags(y);for(var x=0;x<A.length;x++){p.unClosedTags.push(A[x].outerHTML.replace(/</g,"&lt;").replace(/>/g,"&gt;"))}};var c=function(){var x=s.split(/\n/);var y=s.length/x.length;if(y<150){p.htmlMinified=false}};var l=function(x){chrome.extension.sendMessage({type:MSG_TYPE.GET_HTML,link:location.href.split("#")[0]},function(y){s=y.content;chrome.extension.sendMessage({type:MSG_TYPE.HTML_READY});x&&x()})};var k=function(x){l(x)};var f=function(x){a();w();h();m();j();v();o();r();d();b();c();if(x&&typeof x=="function"){x.call(null,p)}};return{init:k,detect:f}})();